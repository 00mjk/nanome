docker.enabled = true

params {
	executor = 'google-lifesciences'
	GuppyGPUOptions="--gpu_runners_per_device 16 --device auto"
	GuppyNumCallers=16
	megalodonGPUOptions="--devices 0"
	DeepSignal_isgpu = 'yes'
}

google {
	lifeSciences.bootDiskSize = params.gls_bootDiskSize
	lifeSciences.preemptible = params.gls_preemptible
	zone = params.zone
	network = params.network
	subnetwork = params.subnetwork
}

process {
	container = params.containerName
	echo = params.echo
	cpus = params.resquiggle_cpus
	memory =  params.resquiggle_memory

  	withLabel: with_gpus {
		echo = params.echo
		cpus = params.with_gpus_process_cpus
		memory =  params.with_gpus_process_memory
		container = params.containerName
		containerOptions = params.containerOptions
		accelerator = [request: params.n_accelerators, type: params.accelerator ]

	}

	withName: Resquiggle {
		cpus = params.resquiggle_cpus
		memory =  params.resquiggle_memory
	}

	withName: Tombo {
		cpus = params.resquiggle_cpus
		memory =  params.resquiggle_memory
	}

	withName: Megalodon { // We need add memory for Megalodon, so we put it here for special one
		echo = params.echo
		cpus = params.with_gpus_process_cpus
		memory =  params.with_gpus_process_memory
		container = params.containerName
		containerOptions = params.containerOptions
		accelerator = [request: params.n_accelerators, type: params.accelerator ]
	}
}
